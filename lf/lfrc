set ignorecase true
set icons true
set info size
set ifs "\n"

# show warning when in nested instance
&[ "$LF_LEVEL" -eq 1 ] || lf -remote "send $id echoerr \"Warning: You're in a nested lf instance!\""

# kitty + pistol
# set previewer ~/.config/lf/previewer
# set cleaner ~/.config/lf/cleaner

# ctpv
set previewer ctpv
set cleaner ctpvclear
&ctpv -s $id
&ctpvquit $id

# bat pager
cmd batpage ${{
	bat --color always --paging=always $fx
}}

# create directory
cmd mkdir %{{
	printf "Directory name: "
	read ans
	mkdir $ans
}}

# zoxide ask
cmd zo %{{
	printf "Zoxide: "
	read ans
	result="$(zoxide query --exclude "$PWD" "$ans" | sed 's/\\/\\\\/g;s/"/\\"/g')"
	lf -remote "send $id cd \"$result\""
}}

cmd on-cd &{{
    zoxide add "$PWD"
    lf -remote "send $id tty-write \"\033]0;lf $(pwd | sed "s|^$HOME|~|")\007\""
}}


# kitten icat (as)
cmd icat !{{
	kitten icat $fx
}}

# mappings
map ac mkdir
map az zo
map zz zo
map <enter> shell-pipe
map <c-space> shell
map d
map t
map f filter
map F find
map i batpage
map x cut
map y clear
map c copy
map R %trash-put $fx
map S delete
map w $fish
map as icat
map Q %lf -remote "send $id :cd \"$OLDPWD\"; quit"
